:root{
  --bgA:#fff8ee;
  --bgB:#e9f7ff;
  --ink:#0f172a;
  --muted:#475569;
  --card:rgba(255,255,255,.90);
  --line:rgba(15,23,42,.12);
}

*{ box-sizing:border-box; }
html,body{ height:100%; }

body{
  margin:0;
  overflow:hidden;
  font-family:"Microsoft JhengHei","微軟正黑體",system-ui,Arial,sans-serif;
  color:var(--ink);
  background:
    radial-gradient(1100px 800px at 20% 10%, rgba(255,210,110,.55) 0%, transparent 60%),
    radial-gradient(1100px 800px at 85% 20%, rgba(120,200,255,.55) 0%, transparent 60%),
    linear-gradient(180deg, var(--bgA), var(--bgB));
}

.wrap{ width:90vw; height:90vh; margin:5vh auto; padding:14px; display:flex; flex-direction:column; gap:12px; }

.top{
  display:flex; align-items:flex-end; justify-content:space-between; gap:12px;
  padding:12px 14px; border-radius:16px;
  border:1px solid var(--line);
  background:var(--card);
  backdrop-filter: blur(8px);
  box-shadow:0 18px 40px rgba(15,23,42,.10);
}
.title{ font-size:22px; font-weight:900; letter-spacing:.4px; }
.sub{ font-size:13px; color:var(--muted); margin-top:6px; line-height:1.35; }

.hud{ display:flex; align-items:center; gap:10px; flex-wrap:wrap; justify-content:flex-end; }
.pill{ padding:8px 12px; border:1px solid var(--line); background:rgba(255,255,255,.92); border-radius:999px; font-weight:900; display:flex; align-items:center; gap:8px; }

.btn{
  border:1px solid var(--line);
  background:rgba(255,255,255,.98);
  padding:10px 12px;
  border-radius:12px;
  font-weight:900;
  cursor:pointer;
  font-family:inherit;
}
.btn:hover{ filter:brightness(1.02); }
.btn:active{ transform:scale(.99); }

.btnBig{
  padding:14px 26px;
  font-size:18px;
  border-radius:14px;
}

.stage{
  position:relative;
  flex:1;
  border-radius:18px;
  border:1px solid var(--line);
  background:rgba(255,255,255,.65);
  backdrop-filter: blur(8px);
  box-shadow:0 18px 40px rgba(15,23,42,.10);
  overflow:hidden;
}
canvas{ display:block; width:100%; height:100%; }

.legend{
  position:absolute;
  left:14px;
  bottom:12px;
  display:flex;
  gap:10px;
  flex-wrap:wrap;
  padding:8px 10px;
  border-radius:12px;
  border:1px solid rgba(15,23,42,.12);
  background:rgba(255,255,255,.94);
  font-weight:900;
  font-size:12px;
  box-shadow:0 12px 30px rgba(15,23,42,.12);
}

/* ✅ overlay：背景仍可見，暗 50% */
.overlay{
  position:absolute; inset:0;
  display:flex; align-items:center; justify-content:center;
  background:rgba(0,0,0,.50);
}
.overlay.hidden{ display:none; }

.card{
  width:min(820px,92vw);
  border-radius:18px;
  border:1px solid var(--line);
  background:rgba(255,255,255,.96);
  box-shadow:0 24px 60px rgba(15,23,42,.18);
  padding:16px;
  transform-origin:center center;
}
.card.pop{ animation: popIn .42s cubic-bezier(.2,1.35,.25,1) both; }
@keyframes popIn{
  0%{ transform: translateY(14px) scale(.84); opacity:0; }
  100%{ transform: translateY(0) scale(1); opacity:1; }
}

.panel.hidden{ display:none; }
.hidden{ display:none; }

.cardTitle{ font-size:18px; font-weight:950; }
.cardBody{ margin-top:8px; color:var(--muted); line-height:1.55; }
.cardActions{ display:flex; justify-content:flex-end; gap:10px; margin-top:14px; }
.cardActions.center{ justify-content:center; }
.cardRow{ display:flex; align-items:center; gap:10px; margin-top:10px; }
.label{ font-weight:900; color:var(--muted); font-size:13px; }
input{
  width:140px;
  padding:10px 12px;
  border-radius:12px;
  border:1px solid var(--line);
  background:rgba(255,255,255,.98);
  font-weight:900;
  font-family:inherit;
}
.tiny{ margin-top:10px; color:var(--muted); font-size:12px; line-height:1.45; }

.countRow{ display:flex; gap:10px; flex-wrap:wrap; margin-top:12px; }
.countBtn{
  border:1px solid rgba(15,23,42,.12);
  background:rgba(255,255,255,.98);
  border-radius:12px;
  padding:10px 12px;
  font-weight:950;
  cursor:pointer;
  font-family:inherit;
}
.countBtn.active{
  outline: 3px solid rgba(59,130,246,.25);
  border-color: rgba(59,130,246,.35);
}

.catGrid{
  margin-top:12px;
  display:grid;
  grid-template-columns: repeat(2, minmax(0,1fr));
  gap:10px;
}
.catBtn{
  display:flex;
  align-items:flex-start;
  gap:10px;
  padding:12px;
  border-radius:14px;
  border:1px solid rgba(15,23,42,.12);
  background:rgba(255,255,255,.98);
  cursor:pointer;
  justify-content:flex-start;
}
.catBtn:hover{ filter:brightness(1.01); }
.catBtn.disabled{ opacity:.45; cursor:not-allowed; }

.catThumb{
  width:86px; height:64px;
  border-radius:12px;
  border:1px solid rgba(15,23,42,.10);
  background:rgba(240,250,255,.85);
  display:flex; align-items:center; justify-content:center;
  flex:0 0 auto;
}
.catThumb svg{ display:block; }

.catMeta{
  display:flex;
  flex-direction:column;
  align-items:flex-start;
  text-align:left;
  width:100%;
}
.catName{ font-weight:950; width:100%; text-align:left; }
.catDesc{ font-size:12px; color:var(--muted); margin-top:4px; line-height:1.35; width:100%; text-align:left; }
.catSkill{ font-size:12px; color:rgba(15,23,42,.78); margin-top:6px; line-height:1.35; width:100%; text-align:left; }
.catSkill b{ color:rgba(15,23,42,.92); }

.resultTitle,.resultBody,.resultConfetti{ text-align:center; }
.resultTitle{ font-size:22px; font-weight:950; }
.resultBody{ margin-top:10px; font-weight:900; line-height:1.6; color:rgba(15,23,42,.85); }
.resultConfetti{ margin-top:10px; font-size:22px; letter-spacing:2px; animation: shimmer 1.2s ease-in-out infinite; }
@keyframes shimmer{
  0%,100%{ transform:translateY(0); opacity:.9; }
  50%{ transform:translateY(-4px); opacity:1; }
}

.podiumWrap{ display:flex; justify-content:center; margin-top:14px; }
.podium{
  width:min(560px, 90%);
  height:170px;
  display:flex;
  align-items:flex-end;
  justify-content:center;
  gap:12px;
}
.step{
  flex:1;
  border-radius:14px 14px 10px 10px;
  border:1px solid rgba(15,23,42,.12);
  background:rgba(255,255,255,.95);
  box-shadow: 0 14px 30px rgba(15,23,42,.10);
  display:flex;
  flex-direction:column;
  justify-content:flex-end;
  padding:10px;
}
.step .rank{ font-weight:950; opacity:.9; }
.step .who{ font-weight:950; margin-top:4px; }
.step .sc{ color:var(--muted); font-weight:900; margin-top:2px; }

.step.first{ height:160px; }
.step.second{ height:130px; }
.step.third{ height:110px; }
.step.fourth{ height:95px; }

.foot{ display:flex; justify-content:space-between; gap:10px; color:var(--muted); font-size:12px; padding:0 4px; }

/* Skill HUD */
.skillPill{ gap:10px; }
.cdWrap{
  width:92px; height:10px;
  border-radius:999px;
  background:rgba(15,23,42,.10);
  overflow:hidden;
  border:1px solid rgba(15,23,42,.10);
}
.cdBar{
  display:block;
  height:100%;
  width:0%;
  background:rgba(34,197,94,1);
}
.skillHint{
  font-size:12px;
  color:rgba(15,23,42,.75);
  font-weight:950;
  padding:2px 8px;
  border-radius:999px;
  border:1px solid rgba(15,23,42,.12);
  background:rgba(255,255,255,.95);
}

/* Boot panel */
.bootTitle{ font-size:26px; font-weight:1000; text-align:center; }
.bootSub{ margin-top:8px; color:var(--muted); text-align:center; font-weight:900; }
